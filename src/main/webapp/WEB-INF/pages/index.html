<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simplist - Login</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">

    <link rel='stylesheet prefetch'
          href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900|RobotoDraft:400,100,300,500,700,900'>
    <link rel='stylesheet prefetch' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css'>
    <link rel="stylesheet" href="../resources/css/style.css">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic" rel="stylesheet">


    <link href="../resources/css/toolkit-light.css" rel="stylesheet">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

    <style type="text/css">
        .fields {
            padding-left: 300px;
            width: 800px;
        }
    </style>
</head>

<body>
<div id="loginPage">
    <div id="message"></div>
    <div class="pen-title">
        <h1>Simplist</h1><span>Listing made simple</span>

    </div>
    <div class="container">
        <div class="card"></div>
        <div class="card">
            <h1 class="title">Login</h1>
            <form id="login">
                <div class="input-container">
                    <input type="email" id="email" required="required"/>
                    <label for="email">Email</label>
                    <div class="bar"></div>
                </div>
                <div class="input-container">
                    <input type="password" id="password" required="required"/>
                    <label for="password">Password</label>
                    <div class="bar"></div>
                </div>
                <div class="button-container">
                    <button id="login_btn"><span>Go</span></button>
                </div>
            </form>
            <!--<div class="footer"><a href="#">Forgot your password?</a></div>-->
        </div>
        <div class="card alt">
            <div class="toggle"></div>
            <h1 class="title">Register
                <div class="close"></div>
            </h1>
            <form id="register">
                <div class="input-container">
                    <input type="text" id="first_name" required="required"/>
                    <label for="first_name">First Name</label>
                    <div class="bar"></div>
                </div>
                <div class="input-container">
                    <input type="text" id="last_name" required="required"/>
                    <label for="last_name">Last Name</label>
                    <div class="bar"></div>
                </div>
                <div class="input-container">
                    <input type="email" id="new_email" required="required"/>
                    <label for="new_email">Email</label>
                    <div class="bar"></div>
                </div>
                <div class="input-container">
                    <input type="password" id="new_password" required="required"/>
                    <label for="new_password">Password</label>
                    <div class="bar"></div>
                </div>
                <div class="button-container">
                    <button type="submit" form="register" id="register_btn"><span>NEXT</span></button>
                </div>
            </form>
        </div>
    </div>
</div>
<div id="dashboardPage">
    <div class="with-iconav">

        <nav class="iconav">
            <a class="iconav-brand" href="../index.html">
                <span class="icon icon icon-scribd iconav-brand-icon"></span>
            </a>
            <div class="iconav-slider">
                <ul class="nav nav-pills iconav-nav">
                    <li>
                        <a href="../pages/dashboard.html" title="Overview" data-toggle="tooltip" data-placement="right"
                           data-container="body">
                            <span class="icon icon-home"></span>
                            <small class="iconav-nav-label visible-xs-block">Overview</small>
                        </a>
                    </li>
                    <li>
                        <a href="../pages/CreateItem.html" title="" data-toggle="tooltip" data-placement="right"
                           data-container="body" data-original-title="Add Simplist Item">
                            <span class="icon icon-add-to-list"></span>
                            <small class="iconav-nav-label visible-xs-block">Add Simplist Item</small>
                        </a>
                    </li>
                    <li>
                        <a href="/ebay/oauth" id="ebayUrl" target="_blank" title="" data-toggle="tooltip"
                           data-placement="right"
                           data-container="body" data-original-title="Connect Ebay">
                            <img class="inverted" src="../resources/svg/ebay.svg">
                            <small class="iconav-nav-label visible-xs-block">Connect Ebay</small>
                        </a>
                    </li>
                    <li>
                        <a href="/shopify/oauth" target="_blank" title="" data-toggle="tooltip" data-placement="right"
                           data-container="body" data-original-title="Connect Shopify">
                            <img class="inverted" src="../resources/svg/shopify.svg">
                            <small class="iconav-nav-label visible-xs-block">Connect Shopify</small>
                        </a>
                    </li>
                    <li>
                        <a href="/etsy/oauth" id="etsyUrl" target="_blank" title="" data-toggle="tooltip"
                           data-placement="right"
                           data-container="body" data-original-title="Connect Etsy">
                            <img class="inverted" src="../resources/svg/etsy.svg">
                            <small class="iconav-nav-label visible-xs-block">Connect Etsy</small>
                        </a>
                    </li>

                </ul>
            </div>
        </nav>


    </div>


    <div class="fields">
        <br>
        <h3>Create Item</h3>
        <form>
            <div class="form-group">
                <label>Title</label>
                <input class="form-control" id="title" placeholder="Enter Title">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea class="form-control" id="description" placeholder="Enter Description"></textarea>
            </div>
            <div class="form-group">
                <label>Company</label>
                <input class="form-control" id="company" placeholder="Enter Company">
            </div>
            <div class="form-group">
                <label>Type</label>
                <input class="form-control" id="type" placeholder="Enter Type">
            </div>
            <div class="form-group">
                <label>Tags</label>
                <input class="form-control" id="tag" placeholder="Enter Tags">
            </div>
            <div class="form-group">
                <label>Quantity</label>
                <input class="form-control" id="quantity" placeholder="Enter Quantity">
            </div>
            <div class="form-group">
                <label>price</label>
                <input class="form-control" id="price" placeholder="Enter Price">
            </div>
            <label>eBay-specific properties</label>
            <div class="form-group">
                <label>SKU</label>
                <input class="form-control" id="sku" placeholder="Enter SKU">
            </div>
            <div class="form-group">
                <label>Brand</label>
                <input class="form-control" id="brand" placeholder="Enter Brand">
            </div>
            <div class="form-group">
                <label>MPN</label>
                <input class="form-control" id="mpn" placeholder="Enter MPN">
            </div>
            <div class="form-group">
                <label>Image 1 URL</label>
                <input class="form-control" id="image1" placeholder="Enter Image 1 URL">
            </div>
            <div class="form-group">
                <label>Image 2 URL</label>
                <input class="form-control" id="image2" placeholder="Enter Image 2 URL">
            </div>
            <div class="form-group">
                <label>Listing Description</label>
                <textarea class="form-control" id="listingDescription" placeholder="Enter Listing Description"></textarea>
            </div>

            <button type="submit" id="addSubmit" class="btn btn-primary">Submit</button>
        </form>


        <hr>
        <h3>Update Item</h3>
        <form>
            <div class="form-group">
                <label><h3>Enter Product Id to update</h3></label>
                <input class="form-control" id="idU" placeholder="Enter ID">
            </div>
            <div class="form-group">
                <label>Title</label>
                <input class="form-control" id="titleU" placeholder="Enter Title">
            </div>
            <div class="form-group">
                <label>Description</label>
                <input class="form-control" id="descU" placeholder="Enter Description">
            </div>
            <div class="form-group">
                <label>Quantity</label>
                <input class="form-control" id="quantityU" placeholder="Enter Quantity">
            </div>
            <div class="form-group">
                <label>Company</label>
                <input class="form-control" id="companyU" placeholder="Enter Company">
            </div>
            <div class="form-group">
                <label>Type</label>
                <input class="form-control" id="typeU" placeholder="Enter Type">
            </div>
            <div class="form-group">
                <label>Tags</label>
                <input class="form-control" id="tagU" placeholder="Enter Tags">
            </div>
            <div class="form-group">
                <label>price</label>
                <input class="form-control" id="priceU" placeholder="Enter Price">
            </div>
            <button type="submit" id="addSubmitid" class="btn btn-primary">Submit</button>
        </form>


        <h3>Delete Item</h3>
        <form>
            <div class="form-group">
                <label><h3>Enter Product Id to update</h3></label>
                <input class="form-control" id="deleteID" placeholder="Enter ID">
            </div>
            <button type="submit" id="deleteSubmit" class="btn btn-primary">Submit</button>
        </form>


        <table id="allItems" class="table">
            <thead class="thead-inverse">
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Description</th>
                <th>Company</th>
                <th>Type</th>
                <th>Tags</th>
                <th>Price</th>
            </tr>
            </thead>
            <tbody>

            </tbody>
        </table>
        <button id="getAll">Get all Items</button>
    </div>
</div>
</body>
<script>


    $('#getAll').click(function () {
        $.ajax({
            method: "GET",
            url: "http://localhost:8080/simplist/getMyItems",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                var iterable = resp.shopify;
                console.log(iterable);
                console.log(iterable.title);
                // $.each(iterable, function(i, item){
                var myItem = "<tr>" +
                    "<td>" + iterable.id + "</td>" +
                    "<td>" + iterable.title + "</td>" +
                    "<td>" + iterable.body_html + "</td>" +
                    "<td>" + iterable.vendor + "</td>" +
                    "<td>" + iterable.product_type + "</td>" +
                    "<td>" + iterable.tags + "</td>" +
                    "<td>" + iterable.price + "</td>" + "</tr>";
                $(".table tbody").append(myItem);
                // });
            },
            error: function (resp) {
                console.log("ERROR " + resp.responseText + resp.statusText);
            }
        })
    });

    $("#deleteSubmit").click(function () {

        console.log("DELETE CLICKED")
        var id = $("#deleteID").val();
        $.ajax({
            method: "DELETE",
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            url: "http://localhost:8080/simplist/delete?itemID=" + id
        });
    });

    $("#addSubmit").click(function (event) {
        event.preventDefault();
        console.log("Button clicked ");

        /* Etsy */
        var etsyObj = {
            quantity: $("#quantity").val(),
            title: $("#title").val(),
            description: $("#description").val(),
            price: 0.20,
            state: "draft",
            is_supply: true,
            who_made: "i_did",
            when_made: "made_to_order",
            shipping_template_id: 35750756683
        };

        /* Shopify */
        var shopifyObj = {
            title: $("#title").val(),
            body_html: $("#description").val(),
            vendor: $("#company").val(),
            product_type: $("#type").val(),
            tags: $("#tag").val(),
            variants: [{
                price: 0.20
            }]
        };
        var ebayObj = {
            productTitle: $("#title").val(),
            productDescription: $("#description").val(),
            productBrand: $("#brand").val(),
            productMpn: $("#mpn").val(),
            productImageUrls: [$("#image1").val(),$("#image2").val()],
            sku: $("#sku").val(),
            currencyValue: $("#price").val(),
            listingDescription: $("#listingDescription").val()
        };



        var simplestItem = {
            shopifyItem: shopifyObj, etsyItem: etsyObj, ebayItem: ebayObj
        };


        $.ajax({
            method: "POST",
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            url: "http://localhost:8080/simplist/add",
            data: JSON.stringify({shopifyItem: shopifyObj, etsyItem: etsyObj, ebayItem: ebayObj})
        });


        console.log("Added : )");
        /* Ebay */

    });


    $("#addSubmitid").click(function () {

        console.log("Button clicked ");

        var id = $("#idU").val();
        /* Etsy */
        var etsyObj = {
            quantity: $("#quantityU").val(),
            title: $("#titleU").val(),
            description: $("#descU").val(),
            price: 0.20,
            state: "draft",
            is_supply: true,
            who_made: "i_did",
            when_made: "made_to_order",
            shipping_template_id: 35750756683
        };

        /* Shopify */
        var shopifyObj = {
            title: $("#titleU").val(),
            body_html: $("#descU").val(),
            vendor: $("#companyU").val(),
            product_type: $("#typeU").val(),
            tags: $("#tagU").val(),
            variants: [{
                price: 0.20
            }]
        };

        var simplestItem = {
            shopifyItem: shopifyObj, etsyItem: etsyObj
        }


        $.ajax({
            method: "POST",
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            url: "http://localhost:8080/simplist/update",
            data: JSON.stringify({id: id, shopifyItem: shopifyObj, etsyItem: etsyObj})
        });


        console.log("Added : )");
        /* Ebay */

    });


    $(document).ready(function () {
            if ($.cookie("user")) $("#loginPage").css("display", "none");
            else $("#dashboardPage").css("display", "none");
            var url = "http://localhost:8080/";

            $("#ebayUrl").click(function (event) {
                $("#ebayUrl").click(function () {
                    var url = $(this).attr('href');
                    window.open(url, '_blank');
                });
                var interval = setInterval(function () {
                    if ($.cookie("eBayToken"))
                        $.ajax({
                            type: "POST",
                            url: url + "saveEbayToken",
                            cache: false,
                            data: {
                                user: $.cookie("user"),
                                token: $.cookie("eBayToken")
                            },
                            success: function (response) {
                                console.log(response);
                                clearInterval(interval);
                            },
                            error: function (response) {
                                console.log(response);
                                clearInterval(interval);
                            }
                        })
                }, 3000);
            });
            $("#etsyUrl").click(function (event) {
                $("#etsyUrl").click(function () {
                    var url = $(this).attr('href');
                    window.open(url, '_blank');
                });
                console.log($.cookie("etsyToken"))
                var interval = setInterval(function () {
                    if ($.cookie("etsyToken"))
                        $.cookie("user").eBayRefreshToken
                    $.ajax({
                        type: "POST",
                        url: url + "saveEtsyToken",
                        cache: false,
                        data: {
                            user: $.cookie("user"),
                            token: $.cookie("etsyToken")
                        },
                        success: function (response) {
                            console.log(response)
                            clearInterval(interval);
                        },
                        error: function (response) {
                            console.log(response);
                            clearInterval(interval);
                        }
                    })
                }, 3000);
            });


            $("#register").submit(function (event) {
                event.preventDefault();
                var url = "http://localhost:8080/";
                var newUser = {
                    firstName: $("#first_name").val(),
                    lastName: $("#last_name").val(),
                    email: $("#new_email").val(),
                    password: $("#new_password").val(),
                    eBayRefreshToken: "",
                    etsyToken: "",
                    etsySecret: "",
                    shopifyToken: ""
                };
                $.ajax({
                    type: "POST",
                    contentType: "application/json",
                    url: url + "login",
                    cache: false,
                    dataType: "json",
                    data: JSON.stringify(newUser),
                    success: function (response) {
                        $("#message").addClass("alert alert-warning");
                        $("#message").text(response.responseText);
                        $("#message").delay(2000).fadeOut(2000, function () {
                            $("#message").removeAttr("style")
                                .removeAttr("class")
                                .text("");
                        })

                    },
                    error: function (error) {
                        console.log(error);
                        $("#message").addClass("alert alert-warning");
                        $("#message").text(error.responseText);
                        $("#message").delay(2000).fadeOut(2000, function () {
                            $("#message").removeAttr("style")
                                .removeAttr("class")
                                .text("");
                        });
                    }
                })
            });

            $("#login").submit(function (event) {
                event.preventDefault();
                var url = "http://localhost:8080/";
                var email = $("#email").val();
                var password = $("#password").val();
                $.ajax({
                    type: "POST",
                    url: url + "validate",
                    cache: false,
                    data: {
                        "email": email,
                        "password": password
                    },
                    success: function (response) {
                        var url = "http://localhost:8080/";
                        console.log("After validation");
                        console.log(response);
                        $("#loginPage").fadeOut(1000);
                        $("#dashboardPage").fadeIn(1000);
                    },
                    error: function (response) {

                    }

                });
            });
        }
    )
</script>
<script src="//ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>
<script src="../resources/js/index.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
<script>
    // execute/clear BS loaders for docs
    $(function () {
        while (window.BS && window.BS.loader && window.BS.loader.length) {
            (window.BS.loader.pop())()
        }
    })
</script>
</html>